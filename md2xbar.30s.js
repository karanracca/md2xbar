#!/usr/bin/env /Users/karanracca/.nvm/versions/node/v18.16.0/bin/node

// <xbar.title>Md2Xbar</xbar.title>
// <xbar.version>v1.0</xbar.version>
// <xbar.author>Karan Racca</xbar.author>
// <xbar.author.github>karanracca</xbar.author.github>
// <xbar.desc>Display to do list from MD files on Xbar</xbar.desc>
// <xbar.dependencies>node</xbar.dependencies>
// <xbar.abouturl>NA</xbar.abouturl>

// <xbar.var>string(VAR_FILE_PATH=<md file path>): MD File path</xbar.var>

const menubar_icon =
  '|image="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"';
const checked_icon =
  '|image="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"';
const uncheck_icon =
  '|image="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"';

const fs = require("fs");

//const FILE_PATH = "<md file path>";
const FILE_PATH = process.env["VAR_FILE_PATH"];

const md_task_prefix = "- [ ]";
const md_task_done_prefix = "- [x]";

const read = () => {
  const raw_content = fs.readFileSync(FILE_PATH, "utf-8");
  const lines = raw_content.split("\n");

  return lines
    .filter(
      (l) =>
        l.trim().startsWith(md_task_prefix) ||
        l.trim().startsWith(md_task_done_prefix)
    )
    .map((l) => {
      if (l.trim().startsWith(md_task_prefix)) {
        const content = l.replace(md_task_prefix, "");
        return content + uncheck_icon;
      }
      if (l.trim().startsWith(md_task_done_prefix)) {
        const content = l.replace(md_task_done_prefix, "");
        return content + checked_icon;
      }
    });
};

const tasks = read();

console.log(menubar_icon);
console.log(`---`);
console.log(`${tasks.map((t) => t.trim()).join("\n")}`);
